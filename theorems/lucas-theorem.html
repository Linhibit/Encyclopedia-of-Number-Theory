<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¢å¡æ–¯å®šç† - æ•°è®ºç™¾ç§‘</title>
    <link rel="stylesheet" href="../style.css">
    
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
    
    <script 
        id="MathJax-script" 
        async 
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>

<body>
    <div class="article-container" 
         style="max-width: 800px; 
                margin: 40px auto; 
                padding: 20px;">
        
        <nav>
            <a href="../index.html" class="back-home" aria-label="è¿”å›é¦–é¡µ">
                <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
                è¿”å›é¦–é¡µ
            </a>
        </nav>
        
        <header>
            <h1>å¢å¡æ–¯å®šç† (Lucas Theorem)</h1>
        </header>

        <section class="theorem-box" 
                 style="border-left: 5px solid #d32f2f; 
                        background: #fff8f8; 
                        padding: 20px; 
                        margin: 20px 0;">
            
            <strong>å®šç†å†…å®¹ï¼š</strong>
            <p>
                è®¾ $p$ ä¸ºç´ æ•°ï¼Œ$n$ å’Œ $m$ ä¸ºéè´Ÿæ•´æ•°ã€‚å°† $n$ å’Œ $m$ è¡¨ç¤ºä¸º $p$ è¿›åˆ¶æ•°ï¼š
                $$n = n_k p^k + n_{k-1} p^{k-1} + \cdots + n_1 p + n_0$$
                $$m = m_k p^k + m_{k-1} p^{k-1} + \cdots + m_1 p + m_0$$
                å…¶ä¸­ $0 \leq n_i, m_i < p$ã€‚
            </p>
            
            <p>
                åˆ™æœ‰ï¼š
                $$\binom{n}{m} \equiv \prod_{i=0}^k \binom{n_i}{m_i} \pmod{p}$$
            </p>
            
            <p>
                å…¶ä¸­ $\binom{n}{m}$ è¡¨ç¤ºç»„åˆæ•° $C_n^m$ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœæŸä¸ª $m_i > n_i$ï¼Œåˆ™ $\binom{n_i}{m_i} = 0$ï¼Œä»è€Œ $\binom{n}{m} \equiv 0 \pmod{p}$ã€‚
            </p>
        </section>

        <section class="proof" 
                 style="background: #f0f8ff; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>è¯æ˜æ€è·¯ï¼š</h3>
            
            <p>
                <strong>åŸºäºç”Ÿæˆå‡½æ•°çš„è¯æ˜ï¼š</strong>
            </p>
            
            <ol style="line-height: 1.6;">
                <li>
                    è€ƒè™‘æ¨¡ $p$ æ„ä¹‰ä¸‹çš„äºŒé¡¹å¼å®šç†ï¼š
                    $$(1+X)^n = \sum_{m=0}^n \binom{n}{m} X^m$$
                </li>
                <li>
                    ç”±äº $p$ æ˜¯ç´ æ•°ï¼Œæœ‰ $(1+X)^p \equiv 1 + X^p \pmod{p}$ï¼ˆè¿™æ˜¯å› ä¸º $p$ æ•´é™¤ $\binom{p}{k}$ å¯¹äº $0 < k < p$ï¼‰ã€‚
                </li>
                <li>
                    å°† $n$ å†™æˆ $p$ è¿›åˆ¶ï¼š$n = \sum_{i=0}^k n_i p^i$ï¼Œåˆ™ï¼š
                    $$
                    \begin{aligned}
                    (1+X)^n &= \prod_{i=0}^k (1+X)^{n_i p^i} \\
                    &\equiv \prod_{i=0}^k (1+X^{p^i})^{n_i} \pmod{p}
                    \end{aligned}
                    $$
                </li>
                <li>
                    å°†å³è¾¹å±•å¼€ï¼Œ$X^m$ çš„ç³»æ•°å°±æ˜¯ $\prod_{i=0}^k \binom{n_i}{m_i} \pmod{p}$ï¼Œå…¶ä¸­ $m = \sum_{i=0}^k m_i p^i$ã€‚
                </li>
                <li>
                    æ¯”è¾ƒä¸¤è¾¹ $X^m$ çš„ç³»æ•°å³å¾—å®šç†ã€‚
                </li>
            </ol>
        </section>

        <section class="example" 
                 style="background: #f9f9f9; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>ç¤ºä¾‹ï¼š</h3>
            
            <p>
                <strong>ç¤ºä¾‹1ï¼š</strong> è®¡ç®— $\binom{100}{30} \bmod 13$ã€‚
            </p>
            
            <p>
                <strong>è§£æ³•ï¼š</strong>
                <ol>
                    <li>å°† 100 å’Œ 30 è½¬æ¢ä¸º 13 è¿›åˆ¶ï¼š
                        <ul>
                            <li>$100 = 7 \times 13^1 + 9 \times 13^0$ï¼Œæ‰€ä»¥ $n_1=7, n_0=9$</li>
                            <li>$30 = 2 \times 13^1 + 4 \times 13^0$ï¼Œæ‰€ä»¥ $m_1=2, m_0=4$</li>
                        </ul>
                    </li>
                    <li>æ ¹æ®å¢å¡æ–¯å®šç†ï¼š
                        $$\binom{100}{30} \equiv \binom{7}{2} \times \binom{9}{4} \pmod{13}$$
                    </li>
                    <li>è®¡ç®—ï¼š
                        <ul>
                            <li>$\binom{7}{2} = 21 \equiv 8 \pmod{13}$</li>
                            <li>$\binom{9}{4} = 126 \equiv 9 \pmod{13}$</li>
                        </ul>
                    </li>
                    <li>æ‰€ä»¥ $\binom{100}{30} \equiv 8 \times 9 = 72 \equiv 7 \pmod{13}$ã€‚</li>
                </ol>
            </p>
            
            <p>
                <strong>ç¤ºä¾‹2ï¼š</strong> åˆ¤æ–­ $\binom{100}{45}$ æ˜¯å¦èƒ½è¢« 7 æ•´é™¤ã€‚
            </p>
            
            <p>
                <strong>è§£æ³•ï¼š</strong>
                <ol>
                    <li>å°† 100 å’Œ 45 è½¬æ¢ä¸º 7 è¿›åˆ¶ï¼š
                        <ul>
                            <li>$100 = 2 \times 7^2 + 0 \times 7^1 + 2 \times 7^0$ï¼Œæ‰€ä»¥ $n_2=2, n_1=0, n_0=2$</li>
                            <li>$45 = 6 \times 7^1 + 3 \times 7^0$ï¼Œæ‰€ä»¥ $m_1=6, m_0=3$ï¼ˆæ³¨æ„é«˜ä½ä¸º0ï¼‰</li>
                        </ul>
                    </li>
                    <li>ç”±äº $m_2=0 \leq n_2=2$ï¼Œä½† $m_1=6 > n_1=0$ï¼Œæ‰€ä»¥ $\binom{n_1}{m_1} = \binom{0}{6} = 0$ã€‚</li>
                    <li>æ ¹æ®å¢å¡æ–¯å®šç†ï¼Œ$\binom{100}{45} \equiv 0 \pmod{7}$ï¼Œå³èƒ½è¢« 7 æ•´é™¤ã€‚</li>
                </ol>
            </p>
        </section>

        <section class="code-example" 
                 style="background: #2d2d2d; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3 style="color: #f8f8f2;">ä»£ç ç¤ºä¾‹ (JavaScript)ï¼š</h3>
            
            <pre style="background: #1e1e1e; 
                        color: #f8f8f2; 
                        padding: 15px; 
                        border-radius: 5px; 
                        overflow-x: auto;">
<code>// é¢„è®¡ç®—é˜¶ä¹˜å’Œé˜¶ä¹˜çš„é€†å…ƒï¼ˆæ¨¡pï¼‰
function precomputeFactorials(n, p) {
    const fact = new Array(n + 1);
    const invFact = new Array(n + 1);
    
    fact[0] = 1;
    for (let i = 1; i <= n; i++) {
        fact[i] = (fact[i - 1] * i) % p;
    }
    
    // è´¹é©¬å°å®šç†æ±‚é€†å…ƒ
    invFact[n] = modPow(fact[n], p - 2, p);
    for (let i = n - 1; i >= 0; i--) {
        invFact[i] = (invFact[i + 1] * (i + 1)) % p;
    }
    
    return { fact, invFact };
}

// å¿«é€Ÿå¹‚ç®—æ³•
function modPow(base, exp, mod) {
    if (mod === 1) return 0;
    let result = 1n;
    base = BigInt(base) % BigInt(mod);
    let e = BigInt(exp);
    while (e > 0n) {
        if (e % 2n === 1n) {
            result = (result * base) % BigInt(mod);
        }
        e >>= 1n;
        base = (base * base) % BigInt(mod);
    }
    return Number(result);
}

// ä½¿ç”¨é¢„è®¡ç®—æ±‚ç»„åˆæ•° C(n, m) mod pï¼ˆn, m < pï¼‰
function combModPrecomputed(n, m, fact, invFact, p) {
    if (m < 0 || m > n) return 0;
    if (m === 0 || m === n) return 1;
    
    return (fact[n] * invFact[m] % p) * invFact[n - m] % p;
}

// å¢å¡æ–¯å®šç†è®¡ç®—ç»„åˆæ•° C(n, m) mod p
function lucasTheorem(n, m, p) {
    if (m === 0) return 1;
    
    // å°†n, mè½¬æ¢ä¸ºpè¿›åˆ¶
    const nDigits = [];
    const mDigits = [];
    
    let tempN = n, tempM = m;
    while (tempN > 0 || tempM > 0) {
        nDigits.push(tempN % p);
        mDigits.push(tempM % p);
        tempN = Math.floor(tempN / p);
        tempM = Math.floor(tempM / p);
    }
    
    // ç¡®ä¿ä¸¤ä¸ªæ•°ç»„é•¿åº¦ç›¸åŒ
    const len = Math.max(nDigits.length, mDigits.length);
    while (nDigits.length < len) nDigits.push(0);
    while (mDigits.length < len) mDigits.push(0);
    
    // é¢„è®¡ç®—é˜¶ä¹˜ï¼ˆåªéœ€è®¡ç®—åˆ°p-1ï¼‰
    const { fact, invFact } = precomputeFactorials(p - 1, p);
    
    // åº”ç”¨å¢å¡æ–¯å®šç†
    let result = 1;
    for (let i = 0; i < len; i++) {
        const ni = nDigits[i];
        const mi = mDigits[i];
        
        if (mi > ni) {
            return 0; // C(ni, mi) = 0
        }
        
        result = (result * combModPrecomputed(ni, mi, fact, invFact, p)) % p;
    }
    
    return result;
}

// ç¤ºä¾‹ä½¿ç”¨
console.log("=== å¢å¡æ–¯å®šç†ç¤ºä¾‹ ===");

// ç¤ºä¾‹1ï¼šC(100, 30) mod 13
const p1 = 13;
const result1 = lucasTheorem(100, 30, p1);
console.log(`C(100, 30) mod ${p1} = ${result1}`); // åº”ä¸º7

// ç¤ºä¾‹2ï¼šC(100, 45) mod 7
const p2 = 7;
const result2 = lucasTheorem(100, 45, p2);
console.log(`C(100, 45) mod ${p2} = ${result2}`); // åº”ä¸º0

// ç¤ºä¾‹3ï¼šéªŒè¯å°æ•°å­—
const p3 = 5;
console.log(`\néªŒè¯å°æ•°å­—ï¼ˆæ¨¡${p3}ï¼‰:`);
for (let n = 0; n < 10; n++) {
    for (let m = 0; m <= n; m++) {
        // ç›´æ¥è®¡ç®—ï¼ˆä»…é€‚ç”¨äºn, mè¾ƒå°çš„æƒ…å†µï¼‰
        let direct = 1;
        for (let i = 1; i <= m; i++) {
            direct = direct * (n - i + 1) / i;
        }
        direct = direct % p3;
        
        const lucas = lucasTheorem(n, m, p3);
        
        if (direct !== lucas) {
            console.log(`çŸ›ç›¾ï¼šC(${n}, ${m}) mod ${p3}ï¼Œç›´æ¥è®¡ç®—=${direct}ï¼Œå¢å¡æ–¯å®šç†=${lucas}`);
        }
    }
}
console.log("å°æ•°å­—éªŒè¯å®Œæˆï¼");

// æ€§èƒ½æµ‹è¯•
console.log("\n=== æ€§èƒ½æµ‹è¯• ===");
console.time("å¢å¡æ–¯å®šç†");
const bigResult = lucasTheorem(1000000, 500000, 10007);
console.timeEnd("å¢å¡æ–¯å®šç†");
console.log(`C(1000000, 500000) mod 10007 = ${bigResult}`);</code>
            </pre>
        </section>

        <section class="applications" 
                 style="background: #f0f8ff; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>åº”ç”¨ï¼š</h3>
            
            <ol style="line-height: 1.6;">
                <li>
                    <strong>å¤§ç»„åˆæ•°å–æ¨¡ï¼š</strong>
                    å½“ $n$ å’Œ $m$ å¾ˆå¤§ä½†æ¨¡æ•° $p$ æ˜¯ç´ æ•°ä¸”ä¸å¤ªå¤§æ—¶ï¼Œå¢å¡æ–¯å®šç†å¯ä»¥é«˜æ•ˆè®¡ç®—ç»„åˆæ•°æ¨¡ $p$ã€‚
                </li>
                
                <li>
                    <strong>æ•°è®ºé—®é¢˜ï¼š</strong>
                    åˆ¤æ–­ç»„åˆæ•°æ˜¯å¦èƒ½è¢«ç´ æ•°æ•´é™¤ã€‚
                </li>
                
                <li>
                    <strong>ç»„åˆæ•°å­¦ï¼š</strong>
                    ç ”ç©¶äºŒé¡¹å¼ç³»æ•°æ¨¡ç´ æ•°çš„æ€§è´¨ã€‚
                </li>
                
                <li>
                    <strong>å¯†ç å­¦ï¼š</strong>
                    åœ¨æŸäº›å¯†ç ç®—æ³•ä¸­ç”¨äºè®¡ç®—å¤§ç»„åˆæ•°ã€‚
                </li>
            </ol>
        </section>

        <section class="notes" 
                 style="background: #fffde7; 
                        padding: 15px; 
                        margin: 20px 0; 
                        border-left: 3px solid #ffd600;">
            
            <h4>ğŸ“ æ³¨æ„ï¼š</h4>
            <p>
                1. å¢å¡æ–¯å®šç†è¦æ±‚æ¨¡æ•° $p$ æ˜¯ç´ æ•°ã€‚å¯¹äºåˆæ•°æ¨¡æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†åˆ†è§£ä¸ºç´ æ•°å¹‚æ¨¡æ•°ï¼Œç„¶åå¯¹æ¯ä¸ªç´ æ•°å¹‚ä½¿ç”¨æ¨å¹¿çš„å¢å¡æ–¯å®šç†ã€‚<br>
                2. å®šç†çš„ä¸€ä¸ªé‡è¦æ¨è®ºï¼š$\binom{n}{m}$ è¢« $p$ æ•´é™¤å½“ä¸”ä»…å½“åœ¨ $p$ è¿›åˆ¶ä¸‹ï¼Œ$m$ çš„æŸä¸€ä½å¤§äº $n$ çš„å¯¹åº”ä½ã€‚<br>
                3. å¢å¡æ–¯å®šç†çš„è®¡ç®—å¤æ‚åº¦ä¸º $O(\log_p n)$ï¼Œéå¸¸é«˜æ•ˆã€‚
            </p>
        </section>
    </div>
</body>
</html>