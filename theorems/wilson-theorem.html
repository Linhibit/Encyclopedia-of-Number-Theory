<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>威尔逊定理 - 数论百科</title>
    <link rel="stylesheet" href="../style.css">
    
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
    
    <script 
        id="MathJax-script" 
        async 
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
</head>

<body>
    <div class="article-container" 
         style="max-width: 800px; 
                margin: 40px auto; 
                padding: 20px;">
        
        <nav>
            <a href="../index.html" class="back-home" aria-label="返回首页">
                <svg class="icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
                返回首页
            </a>
        </nav>
        
        <header>
            <h1>威尔逊定理 (Wilson's Theorem)</h1>
        </header>

        <section class="theorem-box" 
                 style="border-left: 5px solid #d32f2f; 
                        background: #fff8f8; 
                        padding: 20px; 
                        margin: 20px 0;">
            
            <strong>定理内容：</strong>
            <p>
                对于大于1的自然数 $p$，$p$ 是质数的充分必要条件是：
            </p>
            
            $$(p-1)! \equiv -1 \pmod{p}$$
            
            <p>
                等价地，可以写作 $(p-1)! \equiv p-1 \pmod{p}$。
            </p>
        </section>

        <section class="proof">
            <h3>证明简述：</h3>
            
            <h4>必要性：如果 $p$ 是质数，则 $(p-1)! \equiv -1 \pmod{p}$</h4>
            <p>
                当 $p$ 是质数时，模 $p$ 的非零剩余类构成一个乘法群。对于每个 $a \in \{1, 2, \dots, p-1\}$，
                存在唯一的逆元 $a^{-1} \in \{1, 2, \dots, p-1\}$ 使得 $a a^{-1} \equiv 1 \pmod{p}$。
            </p>
            
            <p>
                在 $1, 2, \dots, p-1$ 中，只有 $1$ 和 $p-1$ 的逆元是它们自身：
                <ul>
                    <li>$1 \cdot 1 \equiv 1 \pmod{p}$</li>
                    <li>$(p-1) \cdot (p-1) \equiv (-1)^2 \equiv 1 \pmod{p}$</li>
                </ul>
                对于其他数 $a$（$2 \leq a \leq p-2$），$a$ 和它的逆元 $a^{-1}$ 是不同且成对出现的。
            </p>
            
            <p>
                因此，将 $1, 2, \dots, p-1$ 中除了 $1$ 和 $p-1$ 以外的数配对，每对的乘积模 $p$ 为 $1$：
                $$(p-1)! = 1 \cdot 2 \cdot 3 \cdots (p-2) \cdot (p-1) \equiv 1 \cdot 1 \cdot 1 \cdots 1 \cdot (p-1) \equiv p-1 \equiv -1 \pmod{p}$$
            </p>
            
            <h4>充分性：如果 $(p-1)! \equiv -1 \pmod{p}$，则 $p$ 是质数</h4>
            <p>
                反证法：假设 $p$ 是合数，则 $p = ab$，其中 $1 < a \leq b < p$。
            </p>
            
            <p>
                如果 $a \neq b$，那么 $a$ 和 $b$ 都是 $(p-1)!$ 的因子，所以 $p = ab$ 整除 $(p-1)!$。
                于是 $(p-1)! \equiv 0 \pmod{p}$，与 $(p-1)! \equiv -1 \pmod{p}$ 矛盾。
            </p>
            
            <p>
                如果 $a = b$（即 $p = a^2$），且 $p > 4$，则 $a \geq 3$，且 $2a < a^2 = p$，
                所以 $a$ 和 $2a$ 都是 $(p-1)!$ 的因子，因此 $p = a^2$ 整除 $(p-1)!$，同样导致矛盾。
                
                对于 $p = 4$，直接验证：$(4-1)! = 6 \equiv 2 \not\equiv -1 \pmod{4}$。
            </p>
            
            <p>
                因此，若 $(p-1)! \equiv -1 \pmod{p}$，则 $p$ 必须是质数。
            </p>
            
            <span style="float:right">$\square$</span>
        </section>

        <section class="example" 
                 style="background: #f9f9f9; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>示例：</h3>
            
            <p>
                <strong>示例1：验证质数</strong><br>
                取 $p = 5$（质数）：
                $$(5-1)! = 4! = 24 \equiv -1 \pmod{5}$$
                因为 $24 \div 5 = 4 \cdots 4$，而 $4 \equiv -1 \pmod{5}$，成立。
            </p>
            
            <p>
                <strong>示例2：验证合数</strong><br>
                取 $p = 6$（合数）：
                $$(6-1)! = 5! = 120 \equiv 0 \pmod{6}$$
                因为 $120 \div 6 = 20 \cdots 0$，所以 $120 \equiv 0 \not\equiv -1 \pmod{6}$，不满足威尔逊定理。
            </p>
            
            <p>
                <strong>示例3：特殊情况 $p = 2, 3$</strong><br>
                <ul>
                    <li>$p = 2$：$(2-1)! = 1! = 1 \equiv -1 \pmod{2}$（因为 $-1 \equiv 1 \pmod{2}$）</li>
                    <li>$p = 3$：$(3-1)! = 2! = 2 \equiv -1 \pmod{3}$</li>
                </ul>
            </p>
            
            <p>
                <strong>示例4：求模逆元</strong><br>
                威尔逊定理可以用于求模逆元。例如，在模质数 $p=7$ 下，求 $6$ 的逆元：
                <br>
                由威尔逊定理：$6! \equiv -1 \pmod{7}$，即 $720 \equiv -1 \pmod{7}$。
                <br>
                注意到 $6! = 6 \times 5!$，所以 $6 \times 5! \equiv -1 \pmod{7}$。
                <br>
                两边乘以 $6$ 的逆元 $6^{-1}$（模 $7$）得：$5! \equiv -6^{-1} \pmod{7}$。
                <br>
                计算 $5! = 120 \equiv 1 \pmod{7}$，所以 $1 \equiv -6^{-1} \pmod{7}$，即 $6^{-1} \equiv -1 \equiv 6 \pmod{7}$。
                <br>
                验证：$6 \times 6 = 36 \equiv 1 \pmod{7}$。
            </p>
        </section>

        <section class="code-example" 
                 style="background: #f5f5f5; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>代码示例 (JavaScript)：</h3>
            
            <pre style="background: #2d2d2d; 
                        color: #f8f8f2; 
                        padding: 15px; 
                        border-radius: 5px; 
                        overflow-x: auto;">
<code>// 使用威尔逊定理判断质数（理论上正确，但实际上仅适用于小整数）
function isPrimeByWilson(n) {
    if (n <= 1) return false;
    if (n === 2) return true;
    
    // 计算 (n-1)! mod n
    let factorialMod = 1;
    for (let i = 2; i <= n - 1; i++) {
        factorialMod = (factorialMod * i) % n;
    }
    
    // 检查是否等于 n-1（即 -1 mod n）
    return factorialMod === n - 1;
}

// 对比：试除法判断质数（更实用）
function isPrimeByTrialDivision(n) {
    if (n <= 1) return false;
    if (n <= 3) return true;
    if (n % 2 === 0 || n % 3 === 0) return false;
    
    for (let i = 5; i * i <= n; i += 6) {
        if (n % i === 0 || n % (i + 2) === 0) return false;
    }
    
    return true;
}

// 验证威尔逊定理对小质数的正确性
function verifyWilsonTheorem(limit) {
    console.log(`验证威尔逊定理对于 2 到 ${limit} 的整数：`);
    
    for (let n = 2; n <= limit; n++) {
        const wilsonResult = isPrimeByWilson(n);
        const trialResult = isPrimeByTrialDivision(n);
        
        if (wilsonResult !== trialResult) {
            console.log(`矛盾：n=${n}，威尔逊定理判断为${wilsonResult}，试除法判断为${trialResult}`);
            return false;
        }
    }
    
    console.log(`所有 ${limit} 以内的整数验证通过！`);
    return true;
}

// 示例使用
console.log("威尔逊定理判断质数：");
console.log(`isPrimeByWilson(5) = ${isPrimeByWilson(5)}`);   // true
console.log(`isPrimeByWilson(6) = ${isPrimeByWilson(6)}`);   // false
console.log(`isPrimeByWilson(7) = ${isPrimeByWilson(7)}`);   // true
console.log(`isPrimeByWilson(11) = ${isPrimeByWilson(11)}`); // true

// 验证定理正确性
verifyWilsonTheorem(20);

// 注意：威尔逊定理在理论上有用，但实际判断大质数时效率极低
// 因为需要计算 (n-1)! mod n，时间复杂度为 O(n)
console.log("\n效率对比（n=10000时）：");
console.time("威尔逊定理");
isPrimeByWilson(10000);
console.timeEnd("威尔逊定理");

console.time("试除法");
isPrimeByTrialDivision(10000);
console.timeEnd("试除法");</code>
            </pre>
            
            <p style="margin-top: 15px;">
                <strong>注意：</strong>
                威尔逊定理虽然给出了质数的一个完美刻画，但实际用于判断质数时效率极低，
                因为计算 $(p-1)! \bmod p$ 需要 $O(p)$ 的时间复杂度。在实践中，
                有更高效的质数测试算法（如米勒-拉宾素性测试）。
            </p>
        </section>

        <section class="applications" 
                 style="background: #f0f8ff; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>应用与推论：</h3>
            
            <ol style="line-height: 1.6;">
                <li>
                    <strong>质数判定：</strong>
                    虽然效率不高，但威尔逊定理给出了质数的一个充要条件，具有理论价值。
                </li>
                <li>
                    <strong>模逆元计算：</strong>
                    在模质数 $p$ 下，可以利用威尔逊定理计算某些数的逆元。
                </li>
                <li>
                    <strong>二次剩余：</strong>
                    威尔逊定理与二次剩余理论密切相关。特别地，对于奇质数 $p$，有：
                    $$\left(\left(\frac{p-1}{2}\right)!\right)^2 \equiv (-1)^{\frac{p+1}{2}} \pmod{p}$$
                </li>
                <li>
                    <strong>同余方程：</strong>
                    可用于求解某些特殊的同余方程。
                </li>
                <li>
                    <strong>理论证明：</strong>
                    在数论证明中，威尔逊定理有时会作为引理使用。
                </li>
            </ol>
        </section>

        <section class="notes" 
                 style="background: #fffde7; 
                        padding: 15px; 
                        margin: 20px 0; 
                        border-left: 3px solid #ffd600;">
            
            <h4>📝 历史背景：</h4>
            <p>
                威尔逊定理以英国数学家<strong>约翰·威尔逊</strong>（John Wilson，1741-1793）命名，
                但威尔逊并不是第一个发现这一定理的人。实际上，莱布尼茨早在1682年就知道这个结果。
            </p>
            
            <p>
                这一定理首次由<strong>爱德华·华林</strong>（Edward Waring）在1770年发表，
                并归功于他的学生约翰·威尔逊。华林还提到这个定理可能最早来自莱布尼茨。
            </p>
            
            <p>
                <strong>第一个完整证明</strong>由<strong>拉格朗日</strong>（Joseph-Louis Lagrange）在1773年给出。
                高斯在1801年的《算术研究》中也讨论了这个定理。
            </p>
            
            <p>
                <strong>有趣的事实：</strong>
                威尔逊本人似乎从未给出过证明，甚至可能不知道如何证明。
            </p>
        </section>

        <section class="corollary" 
                 style="background: #f8f0ff; 
                        padding: 20px; 
                        margin: 20px 0; 
                        border-radius: 5px;">
            
            <h3>相关定理：</h3>
            
            <ol style="line-height: 1.6;">
                <li>
                    <strong>费马小定理：</strong>
                    若 $p$ 为质数，$a$ 不被 $p$ 整除，则 $a^{p-1} \equiv 1 \pmod{p}$。
                    这是威尔逊定理的一个弱化形式（威尔逊定理可推出费马小定理）。
                </li>
                <li>
                    <strong>欧拉定理：</strong>
                    若 $\gcd(a, n) = 1$，则 $a^{\varphi(n)} \equiv 1 \pmod{n}$。
                    这是费马小定理的推广。
                </li>
                <li>
                    <strong>素数定理：</strong>
                    描述质数分布渐近规律的定理，与威尔逊定理的角度不同。
                </li>
            </ol>
            
            <p style="margin-top: 10px;">
                <strong>威尔逊定理的推广：</strong>
                对于合数 $n$，有类似但不完全相同的结论。当 $n > 4$ 时，
                $n$ 是合数当且仅当 $(n-1)! \equiv 0 \pmod{n}$。
                但有一些例外，如 $n=4$ 时 $(4-1)! \equiv 2 \pmod{4}$，不为0。
            </p>
        </section>
    </div>
</body>
</html>
